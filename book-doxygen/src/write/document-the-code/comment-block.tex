% در ساختار جدید در این بخش بسته‌های مستند در کدهای متفاوت تشریح می‌شود.
% maso 1391
% % در این قسمت به بررسی بسته های ویژه مستند و نحوه پیاده سازی آن در کد ها برای
% % تولید مستند و یکپارچه سازی مستندات فنی که در حین کد نویسی وارد می شود پرداخته
% % خواهد شد.
% % قاسم خان زاده ۹/۲/۱۳۹۰
\section{بسته‌های ویژه مستند}

به طور معمول \glspl{comment} با استفاده از \glspl{comment block} (که
\glspl{stream comment} نامیده می‌شود) یا \glspl{line comment} (که همچنین
\glspl{inline comment} گفته می‌شود) ساختاردهی می‌شود\cite{wiki6}. ساختارهای نحوی
\glspl{comment block} در زبان‌های برنامه سازی، امکان نوشتن
مستند در چندین خط را فراهم می‌کند به گونه‌ای که می‌توان از انواع متفاوت علامت‌ها
مانند فضاهای خالی و خط جدید نیز استفاده کرد. این نوع ساختارها با استفاده از دو
\glspl{delimiter} معرفی می‌شود که یکی \glspl{delimiter} شروع \glspl{comment
block} و دیگری \glspl{delimiter} پایانی در نظر گرفته می‌شود. تمام ساختارهای
ایجاد شده در میان این دو \glspl{delimiter} به عنوان مستند در نظر گرفته می‌شود و
توسط \glspl{compiler} در فرآیند \glspl{compile} نادیده گرفته می‌شود. در بسیار از
زبان‌های برنامه سازی (مانند \lr{MATLAB}) می‌توان این نوع ساختار \glspl{comment
block} را به صورت تو در تو ایجاد کرده در حالی که بسیاری از زبان‌های برنامه سازی
(مانند \lr{java}) این روش را حمایت نمی‌کنند\cite{wiki[7][8][9]}

\glspl{line comment} برخلاف \glspl{comment block} تنها از یک \glspl{delimiter}
برای ایجاد ساختار \glspl{comment} استفاده می‌کند. این نوع مستندها به طور معمول
با یک \glspl{delimiter} شروع شده و تا انتهای خط جاری در نظر گرفته می‌شود. در
برخی از زبان‌های برنامه سازی \glspl{line comment} را حتی از یک ستون تا انتهای خط
در نظر می‌گیرند که در این حالت هیچ \glspl{delimiter}ی مورد استفاده قرار
نمی‌گیرد\cite{wiki9}.

گرچه ممکن است در برخی از زبانهای برنامه سازی تنها یک نوع ساختار \glspl{comment}
مورد حمایت باشد اما در اغلب زبان‌های برنامه سازی، هر دو نوع ساختار
\glspl{comment} پشتیبانی می‌شود. برای نمونه در زبان برنامه سازی \lr{C} با
استفاده از \glspl{delimiter}های \lr{/*} و \lr{*/} \glspl{comment block} و با
استفاده از \lr{//} \glspl{line comment} ایجاد می‌شود در حالی که در زبان برنامه
سازی \lr{Ada} تنها از \glspl{line comment} پشتیبانی می‌شود که با استفاده از
\glspl{delimiter} \lr{--} نمایش داده می‌شود\cite{wiki9}.

در این بخش \glspl{comment block} و \glspl{line comment} در زبان‌های برنامه سازی
متفاوت مورد بررسی قرار خواهد گرفته و نشان داده می‌شود که چگونه می‌توان مستند‌های
فنی و پیاده سازی را با استفاده از آنها ساختاردهی کرد.
\glspl{comment block} کاربردهای متفاوتی دارد و می‌تواند به روش‌های متفاوت و در
مکان‌های متفاوتی ایجاد شود اما در اینجا تنها ساختارهایی مد نظر است که به عنوان
مستندهای فنی ایجاد شده و با استفاده از ابزارهای \glspl{documenter} به قالب‌های
مناسب خروجی تبدیل می‌شود. این نوع ساختارها را می‌توان به عنوان \glspl{comment
block}های خاص در نظر گرفت که در آن با استفاده از توصیف کامل و جامع از اجزای یک
سیستم نرم‌افزاری تلاش می‌شود مستند جامعی از سیستم ایجاد شود. 

از سویی ابزارهای \glspl{documenter} بر اساس ساختارهای معرفی شده در زبان‌های
برنامه سازی روش‌های متفاوتی را برای نوشتن مستند در داخل کد نرم‌افزار ارائه
می‌کنند. این ابزارها بر اساس این ساختارها میان مستندهای فنی و پیاده‌سازی تفاوت
قائل شده و در فرآیند تولید مستند، داده‌های مناسب را از کد استخراج می‌کنند.

\begin{note}
ابزار مورد نظر این کتاب \glspl{doxygen} است از این رو تنها ساختارهای آن مورد
بررسی قرار خواهد گرفت. این ابزار \glspl{documenter} از ساختارهای متفاوتی که در
ابزارهای معادل دیگر استفاده می‌شود حمایت می‌کند از همین رو به عنوان یک ابزار
بسیار قوی در این زمینه مطر است. برای نمونه ابزارهای مانند \lr{JavaDoc} و
\lr{QtDoc} و ساختارهای مورد استفاده آنها نیز مورد حمایت است.
\end{note}

% maos 1381: ساختار مستند جاوا
یکی از ابزارهای قدرتمند \glspl{documenter} \lr{JavaDoc} است که توسط شرکت
\lr{SunMicrosystem} برای زبان برنامه سازی \lr{Java} معرفی شده است. ساختارهای
مناسب \glspl{comment block} در این ابزار، آن را به عنوان محبوب‌ترین ابزار در
زبان برنامه سازی جاوا مطرح ساخته است. در اینجا نیز می‌توان با استفاده از روش
معرفی شده در \lr{JavaDoc} \glspl{comment block}های ویژه خود را معرفی کرد و
مستند‌های مورد نیاز را در آنها به وحود آرود. 
در این روش از دو نشانه \lr{**} برای ایجاد یک \glspl{document block} 
در برنامه استفاده می شود. هر \glspl{comment block} که با \lr{/**} شروع شود به
عنوان یک \glspl{document block} در نظر گرفته می شود و در فرآیند تولید مستند فنی
مورد استفاده قرار می‌گیرد. ساختار کلی \glspl{document block} به صورت زیر است:

\begin{C++}
/**
 * <Document Block>
 */
\end{C++}

در این نمونه قابل مشاهده است که \glspl{document block} با استفاده از نشانه
\lr{/**} شروع شده و در نهایت به نشانه \lr{*/} ختم می‌شود.

\begin{note}
تمام ساختارهای ممکن \glspl{comment} در استاندارد \lr{JavaDoc} به عنوان مستند
پیاده‌سازی در نظر گرفته می‌شود از این رو در ایجاد مستند فنی نهایی مورد استفاده
قرار نخواهد گرفت. اما در اینجا یک استثنا وچود دارد: ابزار \glspl{doxygen} از
استاندارد ابزارهای دیگر مستند سازی نیز حمایت می‌کند از این رو ساختارهای دیگر نیز
وجود دارد که به عنوان مستند فنی در نظر گرفته شود.
\end{note}

% maso 1391: ساختار مستند کیوتی

یکی دیگر از قالب‌هایی که در مستند سازی نرم‌افزارها مورد استفاده قرار می‌گیرد،
ساختارهای معرفی شده در \lr{QtDoc} است که به صورت گسترده در مستند سازی پروژه‌های
\lr{Qt} مورد استفاده قرار می‌گیرد. یکی از مشهورترین پروژه‌هایی که مبتنی بر
\lr{Qt} بوده و به صورت گسترده از قراردادهای \lr{QtDoc} در مستند سازی خود استفاده
می‌کند \lr{KDE} است. ساختارها و قرادادهای مورد استفاده در \lr{QtDoc} نیز در
اینجا مورد حمایت است. در این قرارداد از عبارت \lr{/*!} برای ایجاد
\glspl{document block} استفاده می‌شود و در نهایت به عبارت \lr{*/} ختم می شود.
ساختار کلی \glspl{document block} به صورت زیر است.

\begin{C++}
/*!
 * <Document Block>
 */
\end{C++}

با یک نگاه کوتاه به این ساختار شباهیت میان آ‌ن با ساختارهای
معرفی شده در \lr{JavaDoc} نمودار می‌شود. به هر حال در قراردادهای \glspl{doxygen}
از هردو این ساختارها حمایت می‌شود و توسعه دهنده سیستم مختار است در مواقع مورد
نیاز از آنها استفاده کند.

\begin{note}
استفاده از نشانه \lr{*} ابتدای هر خط در \glspl{document block} اختیاری است و
معمولا برای زیبایی ظاهری مستند‌های ایجاد شده مورد استفاده قرار می‌گیرد. به عنوان
نمونه تک کد زیر نیز یک ساختار معتبر در نظر گرفته می‌شود.

\begin{C++}
/*!
   <Document Block>
 */
\end{C++}

بسیاری از ابزارهای \glspl{code beautifier} تلاش می‌کنند با قرار دادن این نشانه
ابتدای هر خط ساختار مناسبی را در کدهای نوشته شده ایجاد کنند. این نشانه‌ها در
مستند نهایی تولید شده حذف خواهد شد.
\end{note}

در بسیاری از موارد مستند کوتاه بوده لذا نیازی به استفاده از \glspl{comment
block} نیست. در این موارد می‌توان از ساختارهای \glspl{line comment} استفاده
کرد. ساختار کلی \glspl{comment block} با استفاده از ساختارهای \glspl{line
comment} به صورت زیر است.

\begin{C++}
///
/// <Document Block>
///
\end{C++}

این ساختار با توجه به قرادادهای \lr{QtDoc} نیز به فرم زیر خواهد بود.

\begin{C++}
//!
//! <Document Block>
//!
\end{C++}

در این ساختارها از به ترتیب از نمادهای اضافی \lr{/} و \lr{!} برای ایجاد تمیز
میان \glspl{comment block} و مستند پیاده سازی استفاده شده است. توجه به این نکته
الزامی است که در این ساختار ابتدای هر سطر از \glspl{comment block} الگو ثابتی
تکرار می‌شود.

برخی از برنامه نویسان علاقه دارند که مستندهای فنی خود را به گونه‌ای خاص متمایز
از سایر مستندهای دیگر ایجاد کنند. برای نمونه در بسیاری از پیاده‌سازی‌های
مستندهای فنی به صورت زیر ایجاد شده است.

\begin{C++}
/***********************************************
 *  <Document Block>
 ***********************************************/
\end{C++}

برای حمایت از این دسته برنامه نویسان این ساختار نیز در \glspl{doxygen} مورد
حمایت قرار گرفته است. البته مشابه به همین ساختار نیز می‌توان از \glspl{line
comment} نیز استفاده کرد که ساختار کلی آن به صورت زیر است.

\begin{C++}
/////////////////////////////////////////////////
/// <Document Block>
/////////////////////////////////////////////////
\end{C++}


\begin{ebox}% maso 1391: مستند سازی سایر زبانهای برنامه سازی
زبانهای برنامه سازی متفاوتی مانند \lr{Pyton}، \lr{VHDL} و \lr{Fortran} نیز با
استفاده از \glspl{doxygen} مورد حمایت هستند. در این زبان‌ها از ساختارهای متفاوتی
برای ایجاد \glspl{comment block} استفاده می شود.

در زبان برنامه سازی \lr{VHDL} \glspl{comment} با استفاده از یک \lr{-} معرفی
می‌شود از این رو در \glspl{doxygen} با استفاده از نشانه \lr{-!} \glspl{comment
block} را مشخص می‌کند. با استفاده از این روش نه تنها می‌توان مستندها را در یک خط
بلکه به صورت چند خطی نیز ایجاد کرد. به این نکته باید توجه داشته که در مستندهای
چند خط این نشانه ابتدای هر خط باید قرار گیرد.

\glspl{comment block}ها در این زبان برنامه سازی همواره پیش از قسمت‌های مورد نظر
آورده می‌شود. اما تنها یک استثنا وجود دارد و آنهم در مورد \glspl{vhdl:port} است.
\glspl{comment block} در این مورد می‌تواند بعد از تعریف \glspl{vhdl:port}
آورده شود و به عنوان یک توصیف کوتاه از آن در نظر گرفته شود.


زبان برنامه سازی \lr{Fortran} تنها از \glspl{line comment} حمایت می‌کند که با
استفاده از نشانه‌های \lr{*}، \lr{C} یا \lr{!} ابتدای خط ایجاد می‌شود.
\glspl{doxygen} از عبارت‌های \lr{!>} یا \lr{!<} یک \glspl{document block} ایجاد
می‌شود. عبارت‌های \lr{!>}‌و \lr{!!} نیز برای ایجاد مستند در چندین خط مورد
استفاده قرار می‌گیرد.

زبان برنامه سازی \lr{Tcl} نیز یکی دیگر از زبان‌های پرکاربرد است که توسط
\glspl{doxygen} پشتیبانی می‌شود. در این زبان برنامه سازی مستندها تنها به صورت
\glspl{line comment} پشتیبانی می‌شود. از این رو \glspl{document block} با
استفاده از \lr{\#\#} از دیگر \glspl{comment block}ها تمییز داده می‌شود. در این
زبان برنامه سازی هر \glspl{document block} با رسیدن به اولین خط که با \lr{\#}
شروع نشود پایان می‌یابد.

زبان برنامه سازی \lr{Python} نیز جایگاه خاصی در زبان‌های برنامه سازی دارد. در
این زبان برنامه‌سازی از یک گونه خاص مستند استفاده می‌شود که
\glspl{pyton:documentation string} نامیده می‌شود. در این زبان برنامه سازی با
استفاده از \glspl{pyton:documentation string}ها روش منحصر به فردی در ایجاد مستند
فنی پایه ریزی شده است. به هر حال \glspl{doxygen} با استفاده از متن‌های
\glspl{pyton:documentation string} مستند فنی نهایی را ساختاردهی خواهد کرد. علاوه
بر این در این زبان برنامه سازی از سازکار مشابه به زبان برنامه سازی \lr{Tcl} در
ساختار \glspl{comment} استفاده می‌شود. در اینجا نیز \glspl{document block} با
استفاده از نشانه \lr{\#\#} مشخص می‌شوند.
\end{ebox}

\subsection{مستند بعد از عضو}

اگر هدف مستند کردن اعضای یک فایل، ساختار، کلاس یا ساختارهای باشد که از اجزای
متفاوتی تشکیل شده اند (مانند \lr{enum})، بهترین روش نوشتن  مستند هر بخش درست
جایی است که تعریف شده است. در \glspl{doxygen} امکان نوشتن \glspl{document block}
بعد از تعریف یک موجودیت فراهم شده است. ساختار کلی \glspl{document block} بعد از
اجزا به صورت زیر است.

\begin{C++}
<Definition>; /**< <Document block> */
\end{C++}

در این ساختار تنها نشانه \lr{<} به ساختار \glspl{document block} اضافه شده است.
بدیهی است که با اضافه کردن این نشانه به دیگر ساختارهای \glspl{document block}
نیز بتوان از آنها نیز بهره برد. برای نمونه در زیر کدی آورده شده است که ساختارهای
متفاوت برای ایجاد \glspl{document block} بعد از تعریف اجزای یک ساختار داده‌ای
مورد استفاده قرار گرفته است.

\begin{C++}
struct {
	int var; /*!< Description */
	int var; /**< Description */
	int var; //!< Description
	         //!< 
	int var; ///< Description
	         ///<
	int var; //!< Description
	int var; ///< Description
}
\end{C++}

از این روش حتی برای نوشتن مستند پارامترهای ورودی توابع نیز استفاده می‌شود. در کد
زیر یک تابه به نام \lr{foo} تعریف شده که دارای یک پارامتر به نام \lr{v} است. این
پارامتر به عنوان ورودی در نظر گرفته می‌شود. مستند کامل این پارامتر بعد از تعریف
آن آورده شده است.

\begin{C++}
void foo(int v /**< [in] docs for input parameter v. */);
\end{C++}

باید یادآور شد که ساختار این \glspl{document block} مشابه است و معنی آنها مانند
\glspl{document block}هایی است که پیش از این آورده شده است. تنها
تفاوت آنها این است که نشانه \lr{<} در ابتدای آن ها می‌آید و هدف آن قرار دادن
مستند بعد از تعریف اجزای برنامه نویسی است.

در زیر یک نمونه از مستند شده است که شامل تمام مفاهیمی است که تا کنون بیان شده
است.

\begin{C++}
/*! A test class */
class Test
{
  public:
    /** An enum type. 
     *  The documentation block cannot be put after the enum! 
     */
    enum EnumType
    {
      int EVal1,     /**< enum value 1 */
      int EVal2      /**< enum value 2 */
    };
    void member();   //!< a member function.
    
  protected:
    int value;       /*!< an integer value */
};
\end{C++}

\subsection{مستند در مکان های دیگر}

همانطور که در توضیحات بخش قبل آمد، بسته های مستند همیشه در جلوی تعریف یک فایل،
کلاس، یا فضای نام یا در جلوی عضوهای آن می آیند.
یکی از مواری که می تواند به نوشتن مستندهای یک برنامه، ساختاری منظم بدهد، نوشتن
مستندها در جایی غیر از کدهای نوشته شده است. با استفاده از این روش می توان کدها
را در یک فایل و مستندهای مربوط به همان کدها را در فایلی جداگانه نوشت و مستند هر
قسمت را به آن ارجا داد.

\glspl{doxygen} به شما امکان می دهد بسته های مستند را بصورت تجربی هر جایی که می
خواید بگذارید. هزینه‌ٔای که شما برای نگذاشتن بسته مستند بطور مستقیم قبل یا بعد
از یک عنوان می‌پردازید این است که باید مجموعه‌ای از دستورات ساخت یافته را در داخل بسته مستند
قرار دهید. این کار منجر به تکرار اطلاعات می شود.بنابراین جهت پیاده سازی یک
\glspl{document block}، در صورت امکان از دستورهای ساختاری استفاده نکنید مگر
اینکه نیاز به چنین کاری احساس شود.
