

\section{\lr{Mscgen}}

همانگونه که پیش از این اشاره شده با استفاده از این ابزار می‌توان \glspl{message
sequence chart} را در مستند‌ها ایجاد کرد و به خوانایی مستند‌های ایجاد شده افزود.
یک \glspl{message sequence chart} را در مستند می‌توان به دو روش متفاوت ایجاد
کرد. در روش اول با استفاده از برچسب \lr{msc} می‌توان در لابه‌لای مستندهای تکنیکی
نوشته شده نمودارها مورد نیاز ایجاد کرد. استفاده از این دستور امکان بیان جزئیات
کامل \glspl{message sequence chart} را در خود مستند فراهم می‌کند. ساختار کلی این
دستور به صورت زیر است.
 
\begin{C++}
/**
 * \msc
 * [Diagram detail]
 * \endmsc
 */
\end{C++}

با استفاده از این قالب، قمست مستند ایجاد شده به عنوان یک توصیف صحیح از یک
\glspl{message sequence chart} در نظر گرفته می‌شود. همانگونه که این قالب کلی
قابل مشاهده است توصیف نمودار می‌بایست در محدوده ایجاد شده دو دستور \lr{msc} و
\lr{endmsc} قرار گیرد. قراردادهای توصیف نمودار در انتهای این بخش مورد بررسی قرار
گرفته شده است.

\begin{note}
برای استفاده از این دستورها باید بر اساس قراردادها و زبان توصیف نمودار، \glspl{}
را به صورت کامل و بدون اشتباه در میان این دو دستور نوشته شود. در صورتی که
اشتباهی در این توصیف وجود داشده باشد \glspl{documenter} از آن صرف نظر خواهد کرد.
\end{note}

برای نمونه فرض کنید که قراردادی وجود دارد که در آن یک طرف دستوری را ارسال کرده و
دیگری نتیجه اجرای دستور را گزارش می‌دهد. نمودار این قرارداد در نمونه زیر ایجاد
شده است.

\begin{C++}
/**
 * \msc
 * Sender,Receiver;
 * Sender->Receiver [label="Command()"];
 * Sender<-Receiver [label="Ack()"];
 * \endmsc
 */
\end{C++}

با یک دید نه تنها می‌توان مفاهیم به کار رفته در این توصیف را درک کرد بلکه به این
نکته اذعان کرد که توصیف نمودار بسیار شبه به همان توصیف قرارداد خواهد بود. این
شباهت در توصیف یک قرارداد و توصیف نمودار آن یکی از مهم‌ترین خصوصیت‌های این دستور
است.

% maso 1391: تنظیم‌های کلی برای استفاده از دستور

فرآیند کلی تولید یک \glspl{message sequence chart} با استفاده از این دستور به
این قرار است: در گام نخست کاربر توصیف کامل نمودار را در مستند ایجاد کرده و
\lr{Doxygen} را برای تولید مستند نهایی فراخوانی می‌کند، \glspl{documenter} با
مشاهده این دستور توصیف نمودار را استخراج کرده و با استفاده از ابزار \lr{mscgen}
آن را به \glspl{message sequence chart} معادل ترجمه می‌کند و در نهایت نمودار
ایجاد شده را در مستند نهایی ایجاد شده قرار می‌گیرد. در این فرآیند
\glspl{documenter} با استفاده از ابزار جانبی \lr{mscgen} نمودارهای مورد نیاز
کاربر را ایجاد کرده و در در فرآیند تولید مستند نهایی استفاده می‌کند از این رو
باید روشی برای فراخوانی و استفاده از این ابزار برای \glspl{documenter} فراهم
شود. زمانی که ابزار \lr{mscgen} به صورت سیستمی نصب شده باشد و دستور آن به عنوان
یک دستور جدید در کل سیستم قابل دسترسی باشد \lr{Doxygen} به صورت خودکار آن را
تشخیص داده و از آن استفاده می‌کند، اما مشکل اساسی زمانی رخ می‌دهد که این ابزار
به صورت محلی نصب شده و به عنوان یک دستور معرفی نشده باشد. در این حالت با استفاده
از گزینه \lr{MSCGEN\_PATH} می‌توان مسیر این ابزار را برای \glspl{documenter}
تعیین کرد. حالت کلی استفاده از این گزینه در تنظیم‌های مستند به صورت زیر است:

\begin{Shell}
MSCGEN_PATH = <path to mscgen>
\end{Shell}

زمانی که این خصوصیت در پیکره بندی مستند تعریف نشده باشه \glspl{documenter} به
صورت خودکار در مسیرهای استاندارد به دنبال این ابزار جستجو خواهد کرد.

%maso 1391: استفاده از پرونده به عنوان نمودار
اما استفاده از دستور \lr{msc} و توصیف نمودار در خود مستند تنها روش ایجاد
\glspl{message sequence chart} نیست. یک روش بسیار مناسب و پرکاربرد توصیف نمودار
در پرونده‌های جداگانه و استفاده از دستور \lr{mscfile} است. با استفاده از این
دستور می‌توان یک پرونده شامل توصیف یک نمودار را به مستند اضافه کرد. ساختار کلی
این دستور به صورت زیر است:

\begin{C++}
 /**
  * \mscfile <file> ["caption"]
  */
\end{C++}

نخستن پارامتر ورودی این برچسب مسیر پرونده‌ای را که توصیف نمودار در
آن ایجاد شده است و پارامتر دوم زیر نویس نمودار ایجاد شده را تعیین
می‌کنند. پرونده تعیین شده به عنوان نمودار باید در مسیرهایی ایجاد شده باشد که در
پرونده پیکره بندی مشخص شده است. تعیین مسیر پرونده‌های مورد استفاده در این دستور
با استفاده از برچسب \lr{MSCFILE\_DIRS} در پرونده پیکره بندی تعیین می‌شود.

\begin{note}
مسیر پرونده در این دستور نمی‌تواند شامل \glspl{space} باشد، در این حالت مسیر را
باید در میان کوتیشن نوشت. این روش در حالت کلی به صورت زیر است:
\begin{C++}
 /**
  * \mscfile "<file path>" ["caption"]
  */
\end{C++}
\end{note}

%TODO: maso 1391: تنظیم‌های پرونده‌ها

% TOTO: hadi 1391: در مورد ساختار کلی توصیف نمودار
% TOTO: hadi 1391: در مورد نوشتن توضیحات در متن کدهای mscgen

\subsection{موجودیت‌ها}

% arcskip
% IDURL
% ID
% URL
% label

% Lists the entities that will be used in the message sequence chart, in the order
% in which they should appear left to right and horizontally across the page. Note
% that each entity name can or may not be quoted, unless the name is to include a
% space, in which case double quotes are required.
% 
% 
% arctextbgcolour, arctextbgcolor
% arctextcolour, arctextcolor
% arclinecolour, arclinecolor

هر موجودیت در سیستم می‌تواند به موجودیت‌های دیگر سیستم پیام بدهد یا پیامی از
آن‌ها دریافت کند. در واقع موجودیت‌ها نقش اصلی را در \glspl{message sequence
chart} دارند. بنابراین قبل از هر کاری باید موجودیت‌های نمودار را تعیین کرد. برای
تعریف یک موجودیت در نمودار کافی است نام مورد نظر برای موجودیت را بنویسید و پس از
آن یک علامت نقطه ویرگول ($;$) قرار دهید. برای تعریف چند موجودیت هم باید از کاما
استفاده شود. نکته مهم اینکه تعریف موجودیت‌ها را نباید با نقطه ویرگول از هم جدا
کرد و فقط بعد از آخرین موجودیت علامت نقطه ویرگول گذاشته می‌شود. در نموداری که
توسط ابزار \lr{Mscgen} تولید می‌شود موجودیت‌ها از سمت چپ به راست و به همان
ترتیبی که در هنگام تعریف آورده شده‌اند قرار می‌گیرند. در کد زیر نحوه تعریف
موجودیت‌ها نشان داده شده است:

\begin{MSC}
msc {
	entity1, entity2, ... ,	entityn;
	
	# Definition of message(s)
	
}
\end{MSC}

در این کد به تعداد دلخواه موجودیت تعریف کرده‌ایم. همانطور که به راحتی می‌توان از
کد فهمید برای تعریف هر موجودیت کافی است نامی که می‌خواهیم به موجودیت بدهیم را
بیان کنیم. فرض کنید نموداری را به صورت زیر توصیف کرده باشیم:

\begin{MSC}
msc {
	e1, e2, e3;
	
	e1->e2;	
}
\end{MSC}

در تصویر \ref{images/write/graph/mscgen/entity-example-1} نمایی از آنچه توسط
ابزار \lr{Mscgen} برای کد بالا تولید می‌شود نشان داده شده است. توجه شود که در کد
مربوط به این تصویر تنها سه موجودیت را تعریف کرده‌ایم و در نمودار تولید شده
موجودیت‌ها از چپ به راست با همان ترتیبی که در تعریف آمده‌اند قرار گرفته‌اند.

\begin{note}
دستور $e1->e2$ توصیف یک پیام از موجودیت \lr{e1} به موجودیت \lr{e2} است که در 
تصویر \ref{images/write/graph/mscgen/entity-example-1} نیز یک فلش از موجودیت اول
به موجودیت دوم دیده می‌شود.در قسمت~\ref{sec:message} انواع پیام‌ها و توصیف آن‌ها
به طور کامل شرح داده شده است.
در اینجا فقط برای اینکه بتوانیم نمودار مورد نظر را تولید کنیم یک پیام را تعریف کرده‌ایم
چون همانطور که قبلا گفته شد در توصیف نمودار باید حداقل یک موجودیت و حداقل یک پیام تعریف شده باشد.
در غیر این صورت ابزار \lr{Mscgen} با خطا مواجه شده و نمودار مربوطه را تولید نمی‌کند.
\end{note}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.85\textwidth]{images/write/graph/mscgen/entity-example-1}
	\caption[مثالی از نحوه نمایش موجودیت‌ها توسط ابزار \lr{Mscgen}]
	{در این شکل سه موجودیت تعریف شده است. ابزار \lr{Mscgen} برای کد تعریف کننده این موجودیت‌ها 
	تصویری به این صورت نشان می‌دهد.}
	\label{images/write/graph/mscgen/entity-example-1}
\end{figure}

\begin{note}
موجودیت در \lr{UML} با عنوان \lr{life time} شناخته می‌شود.
\end{note}

اگر در نامی که می‌خواهید برای موجودیت خود بگذارید خط فاصله (فضای خالی) وجود
داشته باشد باید نام مورد نظر را بین دو علامت گیومه (\lr{"}) قرار دهید. مثلا فرض
کنید بخواهیم موجودیت‌هایی با نام‌های \lr{Entity One} و \lr{Entity Two} تعریف
کنیم برای این کار باید کد زیر را بنویسید:

\begin{MSC}
msc {
	"Entity One", "Entity Two";
	
	# Defenition of message(s)
}
\end{MSC}

حال فرض کنید نامی طولانی برای موجودیت خود گذاشته‌اید. در این صورت هر بار بخواهید
به این موجودیت ارجاعی داشته باشید (مثلا رابطه‌ای بین آن و یک موجودیت دیگر برقرار
کنید) مجبورید نام آن موجودیت را به طور کامل بیان کنید. به کد زیر توجه کنید:

\begin{MSC}
msc {
	"Entity Number one", "Entity Number two";
	
	"Entity Number one"->"Entity Number two";
}
\end{MSC}

خروجی ابزار \lr{Mscgen} برای این کد در تصویر
\ref{images/write/graph/mscgen/entity-example-2} نشان داده شده است.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.85\textwidth]{images/write/graph/mscgen/entity-example-2}
	\caption[مثالی از نحوه تعریف موجودیت‌هایی با نام‌های طولانی و حاوی خط فاصله]
	{در این شکل خروجی ابزار \lr{Mscgen} برای کد مربوط به تعریف موجودیت‌هایی با نام طولانی نشان داده شده است.}
	\label{images/write/graph/mscgen/entity-example-2}
\end{figure}

برای پرهیز از این کار روش دیگری برای تعریف موجودیت وجود دارد. در این روش یک
موجودیت به همراه یک برچسب خاص تعریف می‌شود. نمونه‌ای از این روش تعریف موجودیت در
کد زیر آورده شده است:

\begin{MSC}
msc {
	a[label="Entity Number one"], b[label="Entity Number two"];
	
	a->b;
}
\end{MSC}

همانطور که در کد بالا دیده می‌شود دستور تعریف موجودیت به این صورت است: ابتدا
نامی که می‌خواهید qبرای ارجاعات بعدی در کد از آن استفاده کنید، سپس بین دو کروشه
ابتدا کلمه \lr{label}، سپس علامت مساوی (=) و در مقابل آن نامی که می‌خواهید در
دیاگرام تولیدی توسط ابزار \lr{Mscgen} برای موجودیت مورد نظر ظاهر شود. در واقع با
این کار برای موجودیت‌ها خصوصیت \lr{label} را تعریف کرده و مقداردهی می‌کنید. در این
روش هم برای تعریف چند موجودیت باید از کاما استفاده کرد و در انتهای تعریف
موجودیت‌ها نقطه‌ویرگول قرار داده شود.

نمودار مربوط به کد اخیر دقیقا مثل نمودار کد قبلی (تصویر
\ref{images/write/graph/mscgen/entity-example-2}) است. اما مشاهده می‌شود که
تعریف پیام‌ها در کد دوم چقدر ساده‌تر و سریع‌تر از کد قبل است.

% TODO: hadi 1391: تعریف خصوصیات مربوط به یک موجودیت
یک موجودیت علاوه بر خصوصیت \lr{label} خصوصیات دیگری نیز دارد که می‌توان آن‌ها را با
مقادیر دلخواه مقداردهی کرد. با خصوصیات مختلف یک موجودیت می‌توان موادی چون رنگ متن
مربوط به نام موجودیت، رنگ پس‌زمینه نام موجودیت، رنگ خط زمانی یا همان
\lr{time-line} موجودیت و \lr{\ldots} را تعیین کرد. به طور کلی برای مقداردهی
خصوصیات مختلف یک موجودیت باید هنگام تعریف موجودیت در مقابل نام آن و بین دو علامت کروشه
([]) خصوصیت مورد نظر را ذکر کرده و مقداری دلخواه خود را به آن خصوصیت بدهید. خصوصیات مختلف
باید با کاما از یکدیگر جدا شوند. شکل کلی مقداردهی به خصوصیات یک موجودیت به این صورت
است:

\begin{MSC}
msc {
	entity1[attribute1="value1" , attribute2="value2" , ... ,
	attribute="value"],
	entity2[attribute1="value1", attribute2="value2", ... ,
	attribute="value"];
	.
	.
	# Definition of messages
	.
	.
}
\end{MSC}

با استفاده از خصوصیت \lr{linecolor} یا \lr{linecolour} می‌توان رنگ خط زمانی
موجودیت را به رنگ دلخواه تغییر داد. با استفاده از خصوصیت \lr{textcolor} یا
\lr{textcolour} نیز می‌توان رنگ متن مربوط به نام موجودیت را تغییر داد و
با استفاده از خصوصیت \lr{textbgcolor} یا \lr{textbgcolour} می‌توان رنگ پس‌زمینه
نام موجودیت را تعیین کرد. لازم به ذکر است که این خصوصیات برای پیام‌ها نیز تعریف
تعریف شده که در بخش~\ref{sec:message} شرح داده شده‌اند. به کد زیر و تصویر معادل
تولید شده توسط ابزار \lr{Mscgen} برای این کد (تصویر \ref{images/write/graph/mscgen/entity-example-3}) توجه نمایید.

\begin{MSC}
msc {
	 a[label="Entity A", linecolor="green", textcolor="red", textbgcolor="yellow"],
	 b[label="Entity B", linecolor="blue", textcolor="#800000", textbgcolor="#c0c0c0"],
	 c[label="Entity C"];
	 
	 a->b;
  	 b->c;
  	 c->c;
  	 a<-c;
  	 a<-b;
}
\end{MSC}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.85\textwidth]{images/write/graph/mscgen/entity-example-3}
	\caption[مثالی از نحوه تعریف خصوصیات مختلف موجودیت‌ها]
	{در این شکل خروجی ابزار \lr{Mscgen} برای کد مربوط به تعریف خصوصیات
	مختلف رنگی موجودیت‌ها نشان داده شده است.}
	\label{images/write/graph/mscgen/entity-example-3}
\end{figure}
 
رنگ قسمت‌های مختلف کلیه پیام‌هایی که از یک موجودیت شروع می‌شوند را نیز می‌توان
در خصوصیات مربوط به همان موجودیت کنترل کرد. با استفاده از خصوصیت
\lr{arclinecolor} یا \lr{arclinecolour} یک موجودیت می‌توان رنگ پیکان تمام
پیام‌هایی که از آن موجودیت شروع می‌شوند را تعیین کرد. به عبارتی با تعیین رنگ
برای این خصوصیت از موجودیت، رنگ پیش‌فرض تمام پیکان‌هایی که از آن موجودیت شروع
می‌شوند را تعیین کرده‌اید. البته می‌توان با تعیین خصوصیت \lr{linecolor} از یک
پیام خاص، رنگ آن پیکان آن پیام را تغییر داد تا از این رنگ پیش‌فرض استفاده نکند.
علاوه بر آن با استفاده از خصوصیت \lr{arctextcolor} یا \lr{arctextcolour} نیز
می‌توان رنگ متن پیام‌هایی که از یک موجودیت شروع می‌شوند را تغییر داد (رنگ متنی
که معمولا در بالای پیکان مربوط به یک پیام قرار می‌گیرد). در این مورد هم با تعیین
رنگ برای این خصوصیت از موجودیت، رنگ متن تمام پیام‌هایی که از آن موجودیت ارسال
می‌شوند را به صورت پیش‌فرض تعیین کرده‌اید.در مورد این خصوصیت هم می‌توان با تعیین
خصوصیت \lr{textcolor} از یک پیام خاص، رنگ متن آن پیام را تغییر داد تا از این رنگ
پیش‌فرض استفاده نکند. همچنین با استفاده از خصوصیت \lr{arctextbgcolor} یا \lr{arctextbgcolour} می‌توان رنگ
پس‌زمینه متن پیام‌هایی که از یک موجودیت شروع می‌شوند را مشخص کرد (رنگ پس‌زمینه
متنی که معمولا در بالای پیکان مربوط به یک پیام قرار می‌گیرد). با تعیین
رنگ برای این خصوصیت از موجودیت، رنگ پس‌زمینه متن تمام پیام‌هایی که از آن موجودیت ارسال می‌شوند را به
صورت پیش‌فرض تعیین کرده‌اید. باز هم می‌توان با تعیین خصوصیت \lr{textbgcolor} از
یک پیام خاص، رنگ پس‌زمینه متن آن پیام را تغییر داد تا از این رنگ پیش‌فرض استفاده
نکند. در زیر یک نمونه کد مثال برای دستکاری این خصوصیات آورده شده است. نمودار
متناظر این کد در تصویر \ref{images/write/graph/mscgen/entity-example-4} آورده
شده است.

\begin{MSC}
msc {
	 a[label="Entity A", arclinecolor="green", arctextcolor="#ffffff", arctextbgcolor="black"],
	 b[label="Entity B", arctextbgcolor="yellow", arctextcolor="#800000"],
	 c[label="Entity C", arclinecolor="blue"];
	 
	 a->b [label="A to B"];
	 a->b [label="A to B (again)"];
	 a->c [label="A to C"];
  	 b->c [label="B to C"];
  	 b->a [label="B to A"];
  	 b->b [label="Cycle on B"];
  	 c->c [label="Cycle on C"];
  	 a<-c;
  	 a<-b [label="reverse()"];
}
\end{MSC}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.85\textwidth]{images/write/graph/mscgen/entity-example-4}
	\caption[مثالی از نحوه تعریف خصوصیات مختلف موجودیت‌ها برای کنترل پیام‌های یک
	موجودیت]
	{در این تصویر نمودار متناظر برای کد مربوط به تعریف خصوصیات
	مختلف رنگی پیام‌های ارسالی از موجودیت‌ها نشان داده شده است.}
	\label{images/write/graph/mscgen/entity-example-4}
\end{figure}

علاوه بر این خصوصیات که تعیین کننده رنگ و ظاهر نمودار نهایی هستند خصوصیات دیگری
نیز برای موجودیت‌ها وجود دارد که با استفاده از آن‌ها می‌توان پیوندها و ارجاعات
را در نمودار مدیریت کرد. با استفاده از خصوصیت \lr{URL} می‌توان پیوندی به
قسمت‌های دیگر مستند و یا به یک تارنما خارج از مستند ایجاد کرد (متن پیوند همان
برچسب موجودیت خواهد بود). وقتی خصوصیت \lr{URL} یک موجودیت مقداردهی شود (مثلا
آدرس یک تارنما به عنوان مقدار به آن داده شود) آنگاه نام موجودیت به صورت یک پیوند
به آن آدرس عمل می‌کند که وقتی خواننده مستند نهایی شما روی آن کلیک کند به آدرس
داده شده هدایت خواهد شد. البته زمانی که از توصیفی اینچنین یک عکس (مثلا در قالب
\lr{png}) تولید شود، این پیوند عمل نمی‌کند و تنها نام موجودیت به رنگ آبی نمایش
می‌یابد. اما هنگامی که از این توصیف برای تولید مستندات از طریق \lr{Doxygen}
استفاده شود نمودارها به صورتی تولید می‌شوند که پیوند مربوطه کار می‌کند. نکته مهم
دیگر این است اگر از توصیف نمودار در مستنداتی که قرار است توسط \lr{Doxygen} تولید
شوند استفاده می‌کنید علاوه بر پیوند به تارنماهای خارج از مستند می‌توانید با
تگ‌‌هایی به صورت \lr{\textbackslash ref\{aaa\}} به محلی در همان مستندات پیوند
ایجاد کنید تا خواننده مستندات با کلیک روی نام موجودیت به آن قسمت از مستندات
هدایت شود. در این تگ عبارت \lr{aaa} محلی در مستند است که می‌خواهید پیوند مورد
نظر به آنجا اشاره کند.

خصوصیت دیگری که برای موجودیت‌ها وجود دارد خصوصیت \lr{ID} است. این خصوصیت در واقع
یک شناسه به صورت بالانویس در مقابل نام موجودیت قرار می‌دهد.
این شناسه ممکن است در پاورقی‌ها (مثلا برای نوشتن توضیحاتی در انتهای متن‌ها و
مستندات) مورد استفاده قرار گیرد. خصوصیت دیگر موجودیت‌ها \lr{IDURL} است. این
خصوصیت دقیقا مثل خصوصیت \lr{URL} عمل می‌کند با این تفاوت که پیوند مربوطه روی
شناسه بالانویسی که در مقابل نام موجودیت است قرار داده می‌شود. نکته مهم اینکه در
صورتی که برای موجودیت خصوصیت \lr{ID} تعریف نشده باشد این خصوصیت کاربردی نخواهد
داشت. به عبارتی این خصوصیت وابسته به تعریف خصوصیت \lr{ID} در موجودیت است. کد زیر
و نمودار معادل آن که در تصویر \ref{images/write/graph/mscgen/entity-example-5}
نشان داده شده یک نمونه مثال برای استفاده از خصوصیات \lr{URL}، \lr{ID} و
\lr{IDURL} در موجودیت‌ها است.

\begin{MSC}
msc {
	 a[label="Arsheet", ID="1", URL="www.arsheet.org"],
	 b[label="My System", ID="2"],
	 c[label="Entity C", ID="id 3", IDURL="www.google.com"];
	 
	 a->b [label="A to B"];
	 a->b [label="A to B (again)"];
	 a->c [label="A to C"];
  	 b->c [label="B to C"];
  	 b->b [label="Cycle on B"];
  	 a<-c;
}
\end{MSC}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.85\textwidth]{images/write/graph/mscgen/entity-example-5}
	\caption[مثالی از نحوه تعریف خصوصیات مختلف موجودیت‌ها برای ایجاد شناسه
	بالانویس و پیوند]
	{در این تصویر نمودار متناظر برای کد مربوط به تعریف
	خصوصیات مختلف مثل پیوند، بالانویس و پیوند روی بالانویس یک موجودیت نشان داده شده
	است.}
	\label{images/write/graph/mscgen/entity-example-5}
\end{figure}

\begin{note}
پیام‌ها نیز دارای خصوصیات \lr{URL}، \lr{ID} و \lr{IDURL} هستند. البته این
خصوصیات برای پیام‌ها تنها زمانی قابل استفاده است که پیام مربوطه دارای نام باشد.
به عبارتی زمانی که خصوصیت \lr{label} مربوط به پیام مقداردهی شده باشد. شرح کامل
پیام‌ها و خصوصیات آن‌ها در بخش~\ref{sec:message} آورده شده است.
\end{note}

\subsection{پیام}
\label{sec:message}

پیام عبارت است یک موجودیت که با استفاده از آن یک نوع ارتباط میان موجودیت‌های یک
سیستم تعیین می‌شود. پیام نه تنها نوع پیام بلکه موجودیت‌های ارسال کنند و دریافت
کننده آن را نیز به صورت کامل مشخص می‌کند. از این رو می‌توان هر پیام را متشکل از
سه بخش کلی در نظر گرفت که عبارت اند از: ارسال کننده، دریافت کننده و نوع پیام. در
\lr{mscgen} هر پیام در حالت کلی به صورت زیر تعریف می‌شود:

\begin{MSC}
<sender> <message type to> <reciver>  ;
\end{MSC}

فرستند و گیرنده دو موجودیت  است که باید پیش از تعریف پیام به صورت کامل تعریف شده
باشند. مکان بیان موجودیت‌ها در ساختار تعریف پیام، ارسال کننده و دریافت کننده
بودن موجودیت را تعیین می‌کند. در این ساختار ارسال کنند در ابتدای رابطه تعریف شده
و دریافت کننده در انتها. شاید در نگاه نخست به این نکته رسیده باشید که اولین
موجودیت در تعریف پیام ارسال کننده و دومین دریافت کننده است اما این تصور اشتباه
است.

هر پیام نه تنها نوع، بلکه فرستنده و یا گیرنده بودن یک موجودیت را
در رابطه تعیین می‌کند. برای نمونه فرض کنید که یک پیام به صورت زیر تعریف شده
باشد.

\begin{MSC}
msc {
	a, b;
	..
	a->b;
}
\end{MSC}

در این صورت موجودیت \lr{a} ارسال کننده و موجودیت \lr{b} دریافت کننده پیام است.
این درحالی است. در نمونه زیر ترتیب ارسال کننده و دریافت کننده پیام برعکس آن چیزی
است که در نمونه قبل آورده شده است.

\begin{MSC}
msc {
	a, b;
	..
	a<-b;
}
\end{MSC}

با یک نگاه اجمالی قابل مشاهده خواهد بود که دو نوع متفاوت پیام که به صورت \lr{->}
و \lr{<-} نمایش داده شده‌اند، فرستنده و گیرنده را به گونه‌های متفاوتی تعیین
می‌کنند. این نکته در شکل \ref{images/write/graph/mscgen/message-type}
قابل مشاهده است. 

\begin{note}
هیچ‌گاه نمی‌توان بدون توجه به نوع پیام تعیین کرد که در \glsp{message sequence
chart} دریافت کننده و ارسال کننده پیام کدام موجودیت است. گرچه دو پیام آورده شده
در نمونه  قبل از یک نوع هستند اما ارسال کننده و دریافت کننده در آنها متفاوت بوده
و به عنوان دو نوع پیام متفاوت در نظر گرفته می‌شوند.
\end{note}

% \begin{figure}
%         \begin{figure}
\begin{figure}
                \centering
                \includegraphics[width=0.4\textwidth]{images/write/graph/mscgen/message-example1}
                \subcaption{
                در این نمودار ارسال کننده موجودیت \lr{a} و دریافت
                کننده موجودیت \lr{b} است. این نکته با توجه به نک پیکان پیام
                قابل درک است.
                }
                \label{images/write/graph/mscgen/message-example1}
\end{figure}
%         \end{subfigure}
%         
%         \begin{subfigure}
\begin{figure}
                \centering
                \includegraphics[width=0.4\textwidth]{images/write/graph/mscgen/message-example2}
                \subcaption{
                در این نمودار ارسال کننده موجودیت \lr{b} و دریافت
                کننده موجودیت \lr{a} است. پیام رد و بدل شده بین این دو موجودیت
                عکس پیام قبل بوده و از همین جهت پیکان رسم شده برای آن نیز وارنه
                است.
                }
                \label{images/write/graph/mscgen/message-example2}
\end{figure}
%         \end{subfigure}
%         \caption{
%         پیام نه تنها نوع بلکه ارسال کننده و دریافت کننده پیام را تعیین می‌کند.
%         در این نمودارها ترتیب موجودیت‌ها در ساختار تعریف پیام مشابه به هم بوده
%         اما نوع پیام منجر به تفسیر متفاوتی از موجودیت‌ها شده است.
%         }
%         \label{images/write/graph/mscgen/message-type}
% \end{figure}

برخلاف موجودیت‌ها گونه‌های متفاوتی از پیام‌ها در ابرار \lr{mscgen} تعریف شده و
قابل استفاده می‌باشد. گرچه در این ابزار الزامی بر تعریف خاص پیام در نظر گرفته
نشده است اما برای درک، بهتر گونه‌های متفاوت بر اساس استاندارد \lr{UML}
نام‌گذاری خواهند شد. تمام گونه‌های پیام در این ابزار عبارت‌اند از:

\begin{itemize}
  \item سیگنال\LTRfootnote{signal}
  \item متد\LTRfootnote{method}
  \item مقدار بازگشتی\LTRfootnote{Return value}
  \item فراخوانی بازگشتی\LTRfootnote{Call back}
  \item انتشار\LTRfootnote{Broad cast}
  \item از دست رفتن پیام\LTRfootnote{Lost message}
\end{itemize}

سیگنال‌های سیستم با استفاد از پیام سیگنال به دیگر موجودیت‌ها انتقال می‌یابد. این
نوع پیام با استفاده از نماید \lr{->} و \lr{<-} نمایش داده می‌شود. در شکل
\ref{write/graph/mscgen/message-signal} هر دو موجودیت سیگنال‌هایی را به یک دیگر
ارسال کرده اند. کد مورد نیاز برای ایجاد این نمودار به صورت زیر است:

\begin{MSC}
msc{
	a, b;
	a -> b[label="Signal"];
	a <- b;
}
\end{MSC}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/message-signal}
\caption[پیام نوع سیگنال]{
	در این نمودار هر دو موجودیت پیام‌هایی از نوع سیگنال را برای یکدیگر ارسال
	کرده‌اند.
}
\label{write/graph/mscgen/message-signal}
\end{figure}

اما به طور معمول در سیستم‌ها سیگنال برای چندین موجودیت‌ها ارسال می‌شود
که اصطلاحا انتشار پیام نام دارد. در حالت کلی هر زمان که نیاز باشد یک پیام برای
تمام موجودیت‌ها ارسال شود از سیگنال انتشار استفاده می شود. سیگنال انتشار با
استفاده از نمادهای \lr{->*} و \lr{*<-} نمایش داده می‌شود. در شکل
\ref{write/graph/mscgen/message-broadcast} یک موجودیت یک سیگنال را برای تمام
موجودیت‌ها از نوع خاص ارسال کرده است. این نمودار به صورت زیر ایجاد می‌شود:

\begin{MSC}
msc{
	a, b1, b2, b3;
	a ->* [label="Signal"];
}
\end{MSC}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/message-broadcast}
\caption[پیام نوع سیگنال همگانی]{
	سیگنال همگانی برخلاف سیگنال برای تعداد زیادی از موجودیت‌ها ارسال می‌شود. در این
	نمودار نیز موجودیت \lr{a} یک سیگنال را برای تمام موجودیت‌هایی از نوع\lr{Type}
	که به عنوان کاربر به حساب می‌آیند ارسال کرده است.
	}
\label{write/graph/mscgen/message-broadcast}
\end{figure}

گونه‌ای دیگر از پیام‌ها فراخوانی متد است. این نوع پیام برخلاف سیگنالها یک
توانایی خاص از سیستم را فراخوانی می‌کنند. برای نمونه در مهندسی نرم‌افزار یک کلاس
می‌تواند به صورت مستقیم یک متد از کلاس دیگر را فراخوانی کند. پیام‌هایی از نوع
متد با استفاده از نماد‌هایی \lr{=>} و \lr{<=} نمایش داده می‌شود. در شکل
\ref{write/graph/mscgen/message-method} دو موجودیت نمایش داده شده‌اند که هرکدام
یک متد از دیگری را فراخوانی کرده است.
این نمودار با استفاده از کد زیر ایجاد می‌شود:

\begin{MSC}
msc{
	a;
	b;
	a => b[label="Method"];
	a <= b;
}
\end{MSC}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/message-method}
\caption[پیام نوع متد]{
	در این نمودار هر دو موجودیت متدهای از یکدیگر را فراخوانی
	می‌کنند.
}
\label{write/graph/mscgen/message-method}
\end{figure}

در بسیاری از موارد در پاسخ فراخوانی یک متد، مقداری به عنوان نتیجه برگردانده
می‌شود. در \lr{mscgen} یک نوع پیام نیز برای این حالت در نظر گرفته شده است. این
نوع پیام‌ها با استفاده از \lr{>>} و \lr{<<} نمایش داده می‌شوند. در شکل
\ref{write/graph/mscgen/message-returnvalue} موجودیت دوم در پاسخ فراخوانی یک
متد مقداری را به عنوان برگشتی به صورت یک پیام برای موجودیت اول ارسال کرده. کد
این نمودار به صورت زیر است:

\begin{MSC}
msc{
	a;
	b;
	a => b;
	a << b[label="Return value"];
}
\end{MSC}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/message-returnvalue}
\caption[مقدار برگشتی به صورت یک پیام]{
	در این نمودار موجودیت \lr{b} یک مقدار را به عنوان نتیجه در مقابل فراخوانی متدش
	به صورت یک پیام، به موجودیت \lr{a} ارسال کرده است.
	}
\label{write/graph/mscgen/message-returnvalue}
\end{figure}

یکی از فراخوانی‌های پیچیده که در سیستم‌های رایانه‌ای بسیار کاربرد دارد
\glspl{callback} است.
در این نوع فراخوانی، یک متد به صورت تکراری فراخوانی شده تا یک شرط اولیه فراهم
شود. برای نمونه یک حلقه در زبان‌های برنامه سازی می‌تواند یک نمونه
\glspl{callback} در نظر گرفته شود. در این فراخوانی تا زمانی که شرط حلقه فراهم
نشده باشد تمام عمل‌های داخل حلقه اجرا خواهد شد. نمایش این نوع فراخوانی‌ها و
ارسال پیام‌ها با یک نوع خاص از پیام نمایش داده می‌شود که با استفاده از نمادهای
\lr{=>>} و \lr{<<=} نمایش داده می‌شود. در شکل
\ref{write/graph/mscgen/message-callback} موجودیت اول یک پیام را به صورت تکراری
برای  موجودیت دوم ارسال کرده است.
کد این نمودار به صورت زیر خواهد بود:

\begin{MSC}
msc{
	a;
	b;
	a =>> b;
}
\end{MSC}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/message-callback}
\caption[فراخوانی مکرر یک متد]{
	در این نمودار موجودیت \lr{a} یک متد از موجودیت \lr{b} را به صورت مکرر فراخوانی
	کرده است.
	}
\label{write/graph/mscgen/message-callback}
\end{figure}

همواره نمی‌توان تصور کرده که پیام‌ها به صورت کاملا درست انتقال می‌یابند. به بیان
دیگر در بسیاری از موارد پیام‌ها در میان راه از بین رفته و به مقصد نمی‌رسند. این
نوع پیام‌ها که پیام‌های از دست رفته نامیده می‌شوند با استفاده از  \lr{-X} و
\lr{X-} نمایش داده می‌شوند. برای نمونه در شکل
\ref{write/graph/mscgen/message-lostmessage} پیام ارسالی از موجودیت اول در راه
رسیدن به موجودیت دوم از دست رفته است. این نمودار به صورت زیر ایجاد می‌شود:

\begin{MSC}
msc{
	a;
	b;
	a -X* b;
}
\end{MSC}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/message-lostmessage}
\caption[از دست رفتن یک پیام]{
	از دست رفتن پیام به خصوصی در قراردادهای شبکه بسیار معمول است. در این نمودار
	پیام ارسال شده از موجودیت \lr{a} در راه رسیدن به موجودیت \lr{b} ناپدید شده است.
	}
\label{write/graph/mscgen/message-lostmessage}
\end{figure}

تنظیم‌های متعددی در \lr{mscgen} در نظر گرفته شده است که با استفاده از آنها
می‌توان نمودارهای متنوعی را ایجاد کرد. از تنظیم رنگ متن و پیام‌های می‌توان به
عنوان نمونه‌های از این تنظیم‌ها یاد کرد. در حالت کلی تنظیم یک پیام به صورت زیر
تعیین می‌شود:

\begin{MSC}
<sender> <message type to> <reciver> [<configur>, ..., <configur>]  ;
\end{MSC}

هر تنظیم با استفاده از یک نام و مقدار به صورت \lr{name=value} تعیین می‌شود که در
آن \lr{name} عنوان خصوصیت و \lr{value} مقدار مورد نظر آن است. برای نمونه خصوصیت
برچسب که به صورت \lr{label} نمایش داده می‌شود عنوان هر پیام را تعیین می‌کند. از
خصوصیت‌های دیگر یک پیام می‌توان به رنگ برچسب آن اشاره کرد. این خصوصیت با نام
\lr{textcolor} نمایش داده می‌شود که مقدار آن یک رنگ است که با نام یا کد مشخص
می‌شود. برای نمونه کد زیر رنگ پیام را به صورت خاکستری تعیین کرده است:

\begin{MSC}
a -> b[label="Simple Message Titel", textcolor="gray"]
\end{MSC}

از عنوان‌هایی مانند \lr{linecolor} و \lr{textbgcolor} نیز برای تعیین رنگ خط
پیکان پیام و رنگ پس زمینه متن پیام استفاده می‌شود که مقادیر آنها نیز به روشی
مشابه تعیین می‌شود.


همانگونه که بخش قبل نیز اشاره شده است، در بسیاری از موارد می‌بایست توضیح تکمیل
کننده در مورد برخیز از پیام‌های آورده شود. در این صورت می‌بایست راهکار مناسبی
برای آدرس دهی یک پیام در شکل‌های ایجاد شده فراهم شود. با استفاده از خصوصیت
\lr{ID} می‌توان برای هر پیام یک شناسه در نظر گرفت. این شناسه به صورت یک متن کوچک
در گوشه بالای سمت راست عنوان پیام نمایش داده می‌شود. با استفاده از این تکنیکی
می‌توان برای پیام‌های دلخا یک شناسه تعیین کرده و در مستندها با استفاده از آن
پیام را تشریح کرد. در شکل \ref{write/graph/mscgen/message-id}
یک نمودار \glspl{message sequence chart} آورده شده است که تعداد متعددی پیام
دارد اما در این نمودار تنها برخی از پیام‌های با استفاده از شناسه نسبت به بقیه
متمایز شده اند. در این صورت می‌توان به سادگی در مستندها به تشریح آنها پرداخت. 
کد زیر این نمودار را ایجاد می‌کند.

\begin{MSC}
msc {
	#Entity
	a[label="Customer"],
	b[label="ATM"], 
	c[label="Bank employee"], 
	d[label="Backup System"];
	#Message sequnce
	a => b[label="Transfer Money", 
		ID="1"];
	b -> c[label="Check Transfer System", 
		URL="\ref BankEmployee#trasactionSignal()"];
	b -> d[label="Store Transaction"];
	a << b[label="Notification", 
		ID="2",
		IDURL="http://wiki.arsheet.org"];
}
\end{MSC}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/message-id}
\caption[تعیین شناسه برای پیام‌ها]{
	در این نمودار پیام‌های خاصی با استفاده از شماره‌های ۱ و ۲ نسبت به بقیه متمایز
	شده اند. با استفاده از این شناسه‌ها می‌توان این پیام‌ها را به صورت کامل در
	مستند تشریح کرد.
	}
\label{write/graph/mscgen/message-id}
\end{figure}

اما استفاده از یک شناسه برای پیام و نوشت مستند در یک مکان دیگر، کاربران را با یک
مشکل اساسی روبرو می‌کند و آن یافتن مستند پیام است. برای رفع این مشکل یک خصوصیت
دیگر با عنوان \lr{IDURL} نیز در نظر گرفته شده است. با استفاده از این خصوصیت
می‌توان با ایجاد یک پیوند در تصویر به متن نوشته شده، خوانندگان مستند را در یافتن
متن مورد نظر یاری کرد. زمانی که برای یک شناسه یک پیون نیز در نظر گرفته شود ابزار
\lr{mscgen} رنگ شناسه را به رنگ یک پیوند تغییر می‌دهد تا کاربر با مشاهده آن
متوجه وجود پیوند شود.

از دیگر خصوصیت‌های در نظر گرفته شده برای پیام می‌توان به \lr{URL} اشاره کرد. با
استفاده از این خصوصیت می‌توان به روش مشابه‌ای که در تعریف شناسه بیان شد،  یک
پیوند به یک مستند ایجاد کرد. برای نمونه فرض کنید که پیام معادل با فراخوانی کی
متد از یک کلاس در زبان‌های برنامه سازی باشد. در این صورت می‌توان آدرس مستند متد
را به عنوان شناسه برای پیام در نظر گرفت. در شکل
\ref{write/graph/mscgen/message-id} یکی از سیگنال‌های تعریف شده دارای پیوند است
از این رو رنگ آن با پیام‌های دیگر متمایز است.

\begin{note}
با توجه به خصوصیت پیوند برای یک پیام، شاید به نظر برسد که استفاده از شناسه و
پیوند شناسه کاربردی نداشته باشد. شناسه و پیوند آن زمانی که مستند تولید شده برای
چاپ مورد استفاده قرار می‌گیرند بسیار پر اهمیت خواهند بود. از این رو زمانی که
مستند تولید شده در چاپ استفاده خواهد شد، تنها می‌بایست از شناسه استفاده شود در
غیر این صورت مستند خوانایی مناسبی ندارد.
\end{note}

\subsection{\glspl{UML:interaction fragment}}

\glspl{UML:interaction fragment} یک موجودیت در \glspl{UML:message sequence chart}
است که به عنوان یک تعامل کلی بین دو موجودیت‌ دیگر در نظر گرفته می‌شود. به صورت
مفهومی می‌توان یک \glspl{UML:message sequence chart} را معادل با یک
\glspl{UML:message sequence chart} در نظر گرفت که میان موجودیت‌ها روی می‌دهد با
این تفاوت که جزئیات آن بیان نمی‌شود. گرچه راهکار کاملا استانداردی برای بیان این
نوع تعامل‌ها میان موجودیت‌ها در نظر گرفته نشده است اما به طور کلی این نوع
تعامل‌ها با استفاده از یک جعبه نمایش داده می‌شود. با استفاده
\glspl{UML:interaction fragment} می‌توان نمودارها را به صورت ساده‌تر ایجاد کرده
و تنها در هر نمودار به بیان نکات مورد نظر خود پرداخت.

حالتی را تصور کنید که دو موجودیت پیش از هر کاری می‌بایست یک کلید امن را میان یک
دیگر به اشتراک گذاشته و پس از آن یک پیام ار یک موجودیت به موجودیت دیگر ارسال
شود. بیان قراردادهای انتقال کلید امن میان این دو موجودیت نه تنها نمودار ایجاد
شده را بسیار پیچیده می‌کند بلکه از انتزاع نمودار ایجاد شده نیز می‌کاهد.
\glspl{UML:message sequence chart} این تعامل را می‌توان مشابه با شکل \ref{}
ایجاد کرد. همانگونه که در این نمودار قابل مشاهده است روش اشتراک کلید امن میان
موجودیت‌ها به صورت انتزائی در نظر گرفته شده است.


\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/box-def}
\caption[تعامل موجودیت‌ها برای اشتراک کلید امن]{
	موجودیت اول و دوم در این نمودار، به صورت کاملا انتزائی ابتدا یک کلید امن را به
	اشتراک گذاشته و پس از آن با الگوریتم‌های از پیش تعریف شده داده‌های خود را رمز و
	برای یکدیگر انتقال می‌دهند. نکته اصلی در این نمودار قرارداد انتقال داده بوده از
	این رو به روش اشتراک کلید امن پرداخته نشده است.
	}
\label{write/graph/mscgen/box-def}
\end{figure}

در حالت کلی \glspl{UML:interaction fragment} را می‌توان به عنوان یک نوع پیام در
نظر گرفت که به گونه‌ای خاص نمایش داده و در بردارنده یک ارتباط کلی است. در
\lr{mscgen} این مفهوم با استفاده از پیامی از نوع \lr{box} نمایش داده می شود.
برای نمونه \glspl{UML:interaction fragment} که در شکل
\ref{write/graph/mscgen/box-def} نمایش داده شده است به صورت زیر ایجاد می‌شود.

\begin{MSC}
msc {
	# Entity
	a[label="Client"],
	b[label="Server"];
	# Messages
	a -> b[label="Upload Request"];
	a box b[label="Share Secure Key", textbgcolour="silver"];
	b => a[label="Set Encryption Method"];
	a => a[label="Encrypt data"];
	a => b[label="Upload Data"];
	b => b[label="Decrypt data& Store"];
}
\end{MSC}

در این نمودار برای نمایش تعامل بین کاربر و کارگزار برای انتقال کلید امن با
استفاده از یک پیام از نوع \lr{box}  نمایش داده شده است که بیانگر همان مفهوم
\glspl{UML:interaction fragment} است. جعبه‌ها به شکل‌های متفاوتی قابل ترسیم
هستند. انواع متفاوت این جعبه‌ها عبارت‌اند از:

\begin{itemize}
  \item \lr{box}
  \item \lr{rbox}
  \item \lr{abox}
  \item \lr{note}
\end{itemize}

یک جعبه یا \lr{box} کاملا شبیه به یک پیام است، از این رو دور از انتظار نیست که
تمام خصوصیت‌های تعریف شده برای یک پیام، در جعبه‌ها نیز قابل استفاده باشد. برای
نمونه با استفاده از خصوصیت‌هایی مانند \lr{ID}، \lr{IDURL} و \lr{URL} می‌توان به
مستند‌های مورد نظر پیوند ایجاد کرد. خصوصیت‌هایی مانند \lr{textcolor} و
\lr{textbgcolor} برای تعیین رنگه متن و پس زمینه جعبه مورد استفاده قرار
می‌گیرد در حالی که با استفاده از خصوصیت‌های مانند \lr{textcolour} و
\lr{textbgcolour} نه تنها می‌توان رنگ عبارت شناسه بلکه پس زمینه آن را نیز تغییر
داد. در شکل \ref{} 
نوع‌های متفاوتی از جعبه با استفاده از خصوصیت‌های متنوع ترسیم شده است. کد مورد
نیاز برای ایجاد این نمودار به صورت زیر است:

\begin{MSC}
# Example MSC using boxes
msc {
   # The entities
   A, B, C, D;
   # Small gap before the boxes
   |||;

   # Next four on same line due to ','
   A box A [label="box"],
   B rbox B [label="rbox"],
   C abox C [label="abox"],
   D note D [label="note"];

   # Example of the boxes with filled backgrounds
   A abox B [label="abox", 
	   textbgcolour="#ff7f7f", 
	   ID="ABOX"];
   B rbox C [label="rbox", 
	   textbgcolour="#7fff7f",  
	   URL="http://wiki.arsheet.org"];
   C note D [label="note", 
	   textbgcolour="#7f7fff", 
	   ID="1", 
	   IDURL="\ref Note#method()"];
}
\end{MSC}

\begin{figure}
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/box-type}
\caption[خصوصیت‌های متفاوت جعبه‌ها]{
	انواع متفاوت جعبه به عنوان پیام در نظر گرفته می‌شود. از این رو می‌توان تمام
	خصوصیت‌های مورد استفاده در پیام‌ها را نیز در اینجا به کار برد.
	}
\label{write/graph/mscgen/box-type}
\end{figure}

\subsection{تنظیم‌های کلی}

دسته‌ای از تنظیم‌های کلی در ترسیم \glspl{UML:message sequence chart} در نظر
گرفته شده است که حالت کلی خروجی را تعیین می‌کند. گرچه این تنظیم‌ها محدود است اما
می‌تواند در تولید خروجی بهتر مفید باشد. مهم‌ترین خصوصیت در ترسیم نمودارها پهنای
تصویر خروجی است. این خصوصیت با استفاده از \lr{width} نمایش داده می‌شود که در
واحد \glspl{pixel} تعیین می‌شود. گرچه ابعاد بزرگ یک تصویر منجر به حجم زیاد خروجی
می‌شود اما در بهبود شکل ایجاد شده بسیار موثر است.

از آنجا که قالب‌های متفاوتی برای تولید خروجی در نظر گرفته شده، و این نکته که
افزایش پهنای تصویر در برخی از این قالب‌ها مناسب نیست، خصوصیت دیگری به نام
\lr{hscale} در نظر گرفته شده است. با استفاده از این خصوصیت نسبت شکل خروجی در
قالب \lr{PNG} به سایر ساختارهای دیگر تعیین می شود که با استفاده از یک عدد اعشاری
و مثبت نمایش داده می‌شود. برای نمونه اگر پنهای خروجی ۶۰۰ \glspl{pixel} در نظر
گرفته شده باشد و خصوصیت \lr{hscale} برابر با 1.5 باشد پهنای شکل ایجاد شده در
قالب \lr{PNG} برابر با 900 \glspl{pixel} خواهد بود.

از دیگر خصوصیت‌ها می‌توان به خصوصیت \lr{arcgradient} اشاره کرد. در ترسیم نمودار
هر پیام در یک محیط به ارتفاع مشخص ترسیم می شود. با استفاده از این خصوصیت می‌توان
این ارتفاع را تعیین کرد. برای نمونه شکل \ref{write/graph/mscgen/message-id} با
تغییر این خصوصیت به مقدار 50 به صورت شکل
\ref{write/graph/mscgen/options-example} تغییر خواهد کرد. کد تغییر یافته این
نمودار به صورت زیر است:

\begin{MSC}
msc {
	# Option
	width="700", hscale="1.5", arcgradient="50";
	#Entity
	a[label="Customer"],
	b[label="ATM"], 
	c[label="Bank employee"], 
	d[label="Backup System"];
	#Message sequnce
	a => b[label="Transfer Money", 
		ID="1"];
	b -> c[label="Check Transfer System", 
		URL="\ref BankEmployee#trasactionSignal()"];
	b -> d[label="Store Transaction"];
	a << b[label="Notification", 
		ID="2",
		IDURL="http://wiki.arsheet.org"];
}
\end{MSC}

\begin{figure}[h]
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/options-example}
\caption[تعیین شناسه برای پیام‌ها]{
	با تغییر خصوصیت‌های کلی نمودار را می‌توان به گونه‌های متفاوتی ترسیم کرد. در
	اینجا با تغییر خصوصیت \lr{arcgradient} فضای مورد استفاده در ترسیم پیام‌های
	افزایش یافته است. این شکل، معادل با شکل \ref{write/graph/mscgen/message-id}
	است اما با این تفاوتی که در این شکل خصوصیت‌های کلی نمودار متفاوتی است.
	}
\label{write/graph/mscgen/options-example}
\end{figure}

در پایان باید به گونه‌ای خاص از موجودیت‌ها اشاره کرد که در هیچ کدام از گروه‌هایی
که پیش از این به آنها اشاره شده قرار نمی‌گیرد. این موجودیت‌ها که برای افزایش
کیفیت نمودارهای تولید مورد استفاده قرار می‌گیرد بسیار ساده اما گاها بسیار
کاربردی هستند.

در نمودارهای \glspl{UML:message sequence chart} عموما می‌توان یک مرز بندی را
میان پیام‌ها در نظر گرفت. از این رو ایجاد مرز میان پیام‌ها می‌تواند در خوانایی
نمودار بسیار موثر باشد. مرز میان پیام‌ها و یا ایجاد قسمت‌هایی متفاوتی
از تعامل‌ها میان موجودیت‌ها با استفاده از سمبل \lr{---} ایجاد می‌شود. در کد
زیر میان دو تعامل کلی یک مرز در نظر گرفته شده است.

\begin{MSC}
msc {
	a, b;
	|||[label="Message Space"];
	a box b[label="Interaction"];
	---[label="Section Bound"];
	a box b[label="Interaction"];
	...[label="Discret Time"];
}
\end{MSC}

علاوه بر مرز میان پیام‌ها از نماد \lr{|||} برای ایجاد فضا میان پیام‌ها و
\lr{\ldots} برای نمایش گسستگی در زمان استفاده می‌شود. تمام این نمادها در شکل
\ref{write/graph/mscgen/options-other} قابل مشاهده است.

\begin{note}
تمام نمادهای تعریف شده مانند پیام در نظر گرفته می‌شوند از این رو تمام
خصوصیت‌هایی که برای پیام تعریف شده است در اینجا نیز قابل استفاده است. در نمونه
قبل از خصوصیت \lr{label} برای این موجودیت‌ها استفاده شده است.
\end{note}


\begin{figure}
\centering
\includegraphics[width=0.9\textwidth]{images/write/graph/mscgen/options-other}
\caption[تعیین شناسه برای پیام‌ها]{
	در \lr{mscgen} موجودیت‌هایی در نظر گرفته شده است که با استفاده  از آنها
	می‌توان به خوانایی نمودار افزود از این موجودیت‌های می‌توان به ترسیم مرز میان
	پیام‌ها اشاره کرد. در این نمودار تمام موجودیت‌های جدید نمایش داده شده است.
	}
\label{write/graph/mscgen/options-other}
\end{figure}